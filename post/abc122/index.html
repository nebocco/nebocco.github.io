<!DOCTYPE html>
<html lang="ja">

<head>
  <title>ã­ã¼ã“ã®æ—¥è¨˜</title>
  <link rel="stylesheet" href="https://nebocco.github.io/main.css">
  <meta charset="utf-8">
  <meta name="description" content="nebocco ã®ãƒ–ãƒ­ã‚°">
  <meta property="og:site_name" content="ã­ã¼ã“ã®æ—¥è¨˜" />
  

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css"
  integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous">

<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js"
  integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh" crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js"
  integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      // customised options
      // â€¢ auto-render specific keys, e.g.:
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '$', right: '$', display: false },
        { left: '\\(', right: '\\)', display: false },
        { left: '\\[', right: '\\]', display: true }
      ],
      // â€¢ rendering keys, e.g.:
      throwOnError: false
    });
  });
</script>


</head>

<body>
  <div class="page-container">
    <header>
      <div id="title">
        <a href="/">ã­ã¼ã“ã®æ—¥è¨˜</a>
      </div>
      <nav>
        <a href="/post">Posts</a>
        <a href="/tags">Tags</a>
        <a href="https://github.com/nebocco" target="_blank" rel="noreferrer noopener">Github</a>
        <a href="https://twitter.com/nebocco27" target="_blank" rel="noreferrer noopener">Twitter</a>
        
        <a href="https://nebocco.github.io/atom.xml" target="_blank" rel="noreferrer noopener">Feed</a>
        
      </nav>
    </header>

    <main id="main">
      <article id="post">
        
<div class="headline">
  <h1 class="page-title">
    ABC122-D We Like AGC è§£èª¬
  </h1>
  
<div class="subtitle">
  <span class="page-date">
    2020-08-22
  </span>
  
  <span class="page-tags">
    
    
    <a class="page-tag" href="https://nebocco.github.io/tags/atcoder/">AtCoder</a>
    
    
    <a class="page-tag" href="https://nebocco.github.io/tags/python/">Python</a>
    
  </span>
  
</div>

</div>

<p>\(O( \log N )\) ã§è§£ãã¾ã™ã€‚</p>
<h2 id="å•é¡Œ">å•é¡Œ</h2>
<p><a href="https://atcoder.jp/contests/abc122/tasks/abc122_d">AtCoder Beginner Contest 122 | D - We Like AGC</a></p>
<h2 id="è§£æ³•">è§£æ³•</h2>
<p>editorial ã®DPè§£æ³•ã‚’ãƒ™ãƒ¼ã‚¹ã«è€ƒãˆã¾ã™ã€‚ \(i\) æ–‡å­—ç›®ã‚’æ±ºã‚ã‚‹éš›ã®é·ç§»ã¯ \(i\) ã®å€¤ã«ã‚ˆã‚‰ãšå¸¸ã«å›ºå®šãªã®ã§ã€æ¼¸åŒ–å¼ã‚’è¡Œåˆ—ã®ç´¯ä¹—ã«è½ã¨ã—è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚64æ¬¡å…ƒç·šå½¢ç©ºé–“ã®è¡Œåˆ—ã‚’æ‰‹æ›¸ãã§å…¥åŠ›ã™ã‚‹ã®ã¯é¢å€’ãªã®ã§ã€ã„ã„æ„Ÿã˜ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ„ã¿ã¾ã™ã€‚æ°—åˆã„ã§é ‘å¼µã£ã¦ãã ã•ã„ğŸ’ª</p>
<p>å§‹çŠ¶æ…‹ã¯ <code>"TTT"</code> ã«ã‚ãŸã‚‹çŠ¶æ…‹ã ã‘1ã«ã—ã¦ãŠãã¨ç‰¹ã«èª¿ç¯€ãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ã—ã‚Œã£ã¨ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’èµ·ã“ã™ã®ã§Pythonã®å¤šå€é•·æ•´æ•°æ¼”ç®—ã«é ¼ã£ã¦ã„ã¾ã™ã€‚</p>
<p>å®šæ•°å€ãŒã¨ã¦ã‚‚å¤§ãã„ã®ã§ã€ã“ã®å•é¡Œã®åˆ¶ç´„ã®ç¯„å›²å†…ã§ã¯ç´ ç›´ã«DPã‚„ãƒ¡ãƒ¢åŒ–å†å¸°ã‚’æ›¸ãã»ã†ãŒæ–­ç„¶æ—©ã„ã§ã™ã€‚</p>
<h2 id="å®Ÿè£…">å®Ÿè£…</h2>
<p><a href="https://atcoder.jp/contests/abc122/submissions/16072743">æå‡ºã‚³ãƒ¼ãƒ‰ï¼ˆPythonï¼‰</a></p>
<pre data-lang="python" style="background-color:#282c34;color:#abb2bf;" class="language-python "><code class="language-python" data-lang="python"><span style="font-style:italic;color:#c678dd;">import </span><span>numpy </span><span style="color:#c678dd;">as </span><span>np
</span><span style="font-style:italic;color:#c678dd;">import </span><span>re
</span><span>
</span><span>mod </span><span style="color:#56b6c2;">= </span><span style="color:#d19a66;">10</span><span style="color:#56b6c2;">**</span><span style="color:#d19a66;">9 </span><span style="color:#56b6c2;">+ </span><span style="color:#d19a66;">7
</span><span>letters </span><span style="color:#56b6c2;">= </span><span style="color:#98c379;">&quot;ACGT&quot;
</span><span>
</span><span style="color:#7f848e;"># æ–‡å­—ã‚’æ·»ãˆå­—ã«
</span><span style="color:#c678dd;">def </span><span style="color:#61afef;">to_int</span><span>(</span><span style="font-style:italic;color:#e06c75;">s</span><span>):
</span><span>    res </span><span style="color:#56b6c2;">= </span><span style="color:#d19a66;">0
</span><span>    </span><span style="color:#c678dd;">for </span><span>x </span><span style="color:#c678dd;">in </span><span>s:
</span><span>        res </span><span style="color:#56b6c2;">&lt;&lt;= </span><span style="color:#d19a66;">2
</span><span>        res </span><span style="color:#56b6c2;">+= </span><span>letters.</span><span style="color:#e06c75;">index</span><span>(x)
</span><span>    </span><span style="color:#c678dd;">return </span><span>res
</span><span>
</span><span style="color:#7f848e;"># æ·»ãˆå­—ã‚’æ–‡å­—ã«
</span><span style="color:#c678dd;">def </span><span style="color:#61afef;">to_str</span><span>(</span><span style="font-style:italic;color:#e06c75;">x</span><span>, </span><span style="font-style:italic;color:#e06c75;">digit</span><span>):
</span><span>    res </span><span style="color:#56b6c2;">= </span><span style="color:#98c379;">&quot;&quot;
</span><span>    </span><span style="color:#c678dd;">for </span><span style="color:#e5c07b;">_ </span><span style="color:#c678dd;">in </span><span style="color:#56b6c2;">range</span><span>(digit):
</span><span>        res </span><span style="color:#56b6c2;">+= </span><span>letters[x</span><span style="color:#56b6c2;">&amp;</span><span style="color:#d19a66;">3</span><span>]
</span><span>        x </span><span style="color:#56b6c2;">&gt;&gt;= </span><span style="color:#d19a66;">2
</span><span>    </span><span style="color:#c678dd;">return </span><span>res[::</span><span style="color:#56b6c2;">-</span><span style="color:#d19a66;">1</span><span>]
</span><span>
</span><span style="color:#7f848e;"># éƒ¨åˆ†æ–‡å­—åˆ—ã¨ã—ã¦å«ã‚“ã§ã¯ã„ã‘ãªã„ã‚‚ã®ã‚’æ­£è¦è¡¨ç¾ã§åˆ¤å®š
</span><span style="color:#c678dd;">def </span><span style="color:#61afef;">is_ok</span><span>(</span><span style="font-style:italic;color:#e06c75;">s</span><span>):
</span><span>    ng </span><span style="color:#56b6c2;">= </span><span>[</span><span style="color:#c678dd;">r</span><span style="color:#98c379;">&quot;AGC&quot;</span><span>, </span><span style="color:#c678dd;">r</span><span style="color:#98c379;">&quot;ACG&quot;</span><span>, </span><span style="color:#c678dd;">r</span><span style="color:#98c379;">&quot;GAC&quot;</span><span>, </span><span style="color:#c678dd;">r</span><span style="color:#98c379;">&quot;A</span><span style="color:#d19a66;">.</span><span style="color:#98c379;">GC&quot;</span><span>, </span><span style="color:#c678dd;">r</span><span style="color:#98c379;">&quot;AG</span><span style="color:#d19a66;">.</span><span style="color:#98c379;">C&quot;</span><span>]
</span><span>    </span><span style="color:#c678dd;">for </span><span>x </span><span style="color:#c678dd;">in </span><span>ng:
</span><span>        </span><span style="color:#c678dd;">if </span><span>re.</span><span style="color:#e06c75;">search</span><span>(x, s):
</span><span>            </span><span style="color:#c678dd;">return </span><span style="color:#d19a66;">False
</span><span>    </span><span style="color:#c678dd;">return </span><span style="color:#d19a66;">True
</span><span>
</span><span style="color:#7f848e;"># è¡Œåˆ—ã®äºŒåˆ†ç´¯ä¹—
</span><span style="color:#c678dd;">def </span><span style="color:#61afef;">mat_power</span><span>(</span><span style="font-style:italic;color:#e06c75;">A</span><span>, </span><span style="font-style:italic;color:#e06c75;">p</span><span>, </span><span style="font-style:italic;color:#e06c75;">mod</span><span>):
</span><span>    res </span><span style="color:#56b6c2;">= </span><span>np.</span><span style="color:#e06c75;">eye</span><span>(A.shape[</span><span style="color:#d19a66;">0</span><span>], </span><span style="font-style:italic;color:#e06c75;">dtype </span><span style="color:#56b6c2;">= </span><span style="color:#98c379;">&quot;object&quot;</span><span>)
</span><span>    </span><span style="color:#c678dd;">while </span><span>p:
</span><span>        </span><span style="color:#c678dd;">if </span><span>p </span><span style="color:#56b6c2;">&amp; </span><span style="color:#d19a66;">1</span><span>:
</span><span>            res </span><span style="color:#56b6c2;">= </span><span>np.</span><span style="color:#e06c75;">dot</span><span>(res, A) </span><span style="color:#56b6c2;">% </span><span>mod
</span><span>        A </span><span style="color:#56b6c2;">= </span><span>np.</span><span style="color:#e06c75;">dot</span><span>(A, A) </span><span style="color:#56b6c2;">% </span><span>mod
</span><span>        p </span><span style="color:#56b6c2;">&gt;&gt;= </span><span style="color:#d19a66;">1
</span><span>    </span><span style="color:#c678dd;">return </span><span>res
</span><span>
</span><span style="color:#7f848e;"># è¡Œåˆ—ä½œæˆå„çŠ¶æ…‹ã‹ã‚‰ã®å„é·ç§»ãŒæœ‰åŠ¹ã‹ç¢ºã‹ã‚ã‚‹
</span><span>A </span><span style="color:#56b6c2;">= </span><span>[[</span><span style="color:#d19a66;">0</span><span>]</span><span style="color:#56b6c2;">*</span><span style="color:#d19a66;">64 </span><span style="color:#c678dd;">for </span><span style="color:#e5c07b;">_ </span><span style="color:#c678dd;">in </span><span style="color:#56b6c2;">range</span><span>(</span><span style="color:#d19a66;">64</span><span>)]
</span><span style="color:#c678dd;">for </span><span>i </span><span style="color:#c678dd;">in </span><span style="color:#56b6c2;">range</span><span>(</span><span style="color:#d19a66;">64</span><span>):
</span><span>    s </span><span style="color:#56b6c2;">= </span><span style="color:#e06c75;">to_str</span><span>(i, </span><span style="color:#d19a66;">3</span><span>)
</span><span>    </span><span style="color:#c678dd;">for </span><span>j </span><span style="color:#c678dd;">in </span><span style="color:#56b6c2;">range</span><span>(</span><span style="color:#d19a66;">4</span><span>):
</span><span>        t </span><span style="color:#56b6c2;">= </span><span>s </span><span style="color:#56b6c2;">+ </span><span style="color:#e06c75;">to_str</span><span>(j, </span><span style="color:#d19a66;">1</span><span>)
</span><span>        </span><span style="color:#c678dd;">if </span><span style="color:#e06c75;">is_ok</span><span>(t):
</span><span>            A[i][</span><span style="color:#e06c75;">to_int</span><span>(t[</span><span style="color:#d19a66;">1</span><span>:])] </span><span style="color:#56b6c2;">= </span><span style="color:#d19a66;">1
</span><span>A </span><span style="color:#56b6c2;">= </span><span>np.</span><span style="color:#e06c75;">array</span><span>(A, </span><span style="font-style:italic;color:#e06c75;">dtype </span><span style="color:#56b6c2;">= </span><span style="color:#98c379;">&quot;object&quot;</span><span>)
</span><span>
</span><span style="color:#7f848e;"># ãƒ™ã‚¯ãƒˆãƒ«ä½œæˆTTTã®ã¿ç«‹ã¦ã¦ãŠã
</span><span>x </span><span style="color:#56b6c2;">= </span><span>[</span><span style="color:#d19a66;">0</span><span>]</span><span style="color:#56b6c2;">*</span><span style="color:#d19a66;">64
</span><span>x[</span><span style="color:#d19a66;">63</span><span>] </span><span style="color:#56b6c2;">= </span><span style="color:#d19a66;">1
</span><span>x </span><span style="color:#56b6c2;">= </span><span>np.</span><span style="color:#e06c75;">array</span><span>(x)
</span><span>
</span><span>N </span><span style="color:#56b6c2;">= int</span><span>(</span><span style="color:#56b6c2;">input</span><span>())
</span><span style="color:#56b6c2;">print</span><span>((np.</span><span style="color:#e06c75;">dot</span><span>(</span><span style="color:#e06c75;">mat_power</span><span>(A, N, mod), x) </span><span style="color:#56b6c2;">% </span><span>mod).</span><span style="color:#e06c75;">sum</span><span>() </span><span style="color:#56b6c2;">% </span><span>mod)
</span></code></pre>



<div class="pagination">
  
  <a class="next" href="https:&#x2F;&#x2F;nebocco.github.io&#x2F;post&#x2F;agc005b&#x2F;">AGC005-B Minimum Sum è§£èª¬</a>
  
  
  <a class="previous" href="https:&#x2F;&#x2F;nebocco.github.io&#x2F;post&#x2F;abc156c&#x2F;">ABC156-C Rally è§£èª¬</a>
  
</div>


      </article>
    </main>

    <footer>
      <span>Â© 2025 nebocco</span>
      <br />
      <span>Generated with <a href="https://www.getzola.org/">Zola</a></span>
    </footer>
  </div>
</body>

</html>